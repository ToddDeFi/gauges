const { ethers } = require('ethers');

const poolFactoryAddress = "0xF1046053aa5682b4F9a81b5481394DA16BE5FF5a";
const gaugeVoterAddress = "0x41C914ee0c7E1A5edCD0295623e6dC557B5aBf3C"

const gaugeVoterAbi = [{"inputs":[{"internalType":"address","name":"_forwarder","type":"address"},{"internalType":"address","name":"_ve","type":"address"},{"internalType":"address","name":"_factoryRegistry","type":"address"},{"internalType":"address","name":"_v1Factory","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"AlreadyVotedOrDeposited","type":"error"},{"inputs":[],"name":"DistributeWindow","type":"error"},{"inputs":[],"name":"FactoryPathNotApproved","type":"error"},{"inputs":[],"name":"GaugeAlreadyKilled","type":"error"},{"inputs":[],"name":"GaugeAlreadyRevived","type":"error"},{"inputs":[{"internalType":"address","name":"_pool","type":"address"}],"name":"GaugeDoesNotExist","type":"error"},{"inputs":[],"name":"GaugeExists","type":"error"},{"inputs":[{"internalType":"address","name":"_gauge","type":"address"}],"name":"GaugeNotAlive","type":"error"},{"inputs":[],"name":"InactiveManagedNFT","type":"error"},{"inputs":[],"name":"MaximumVotingNumberTooLow","type":"error"},{"inputs":[],"name":"NonZeroVotes","type":"error"},{"inputs":[],"name":"NotAPool","type":"error"},{"inputs":[],"name":"NotApprovedOrOwner","type":"error"},{"inputs":[],"name":"NotEmergencyCouncil","type":"error"},{"inputs":[],"name":"NotGovernor","type":"error"},{"inputs":[],"name":"NotMinter","type":"error"},{"inputs":[],"name":"NotWhitelistedNFT","type":"error"},{"inputs":[],"name":"NotWhitelistedToken","type":"error"},{"inputs":[],"name":"SameValue","type":"error"},{"inputs":[],"name":"SpecialVotingWindow","type":"error"},{"inputs":[],"name":"TooManyPools","type":"error"},{"inputs":[],"name":"UnequalLengths","type":"error"},{"inputs":[],"name":"ZeroAddress","type":"error"},{"inputs":[],"name":"ZeroBalance","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"voter","type":"address"},{"indexed":true,"internalType":"address","name":"pool","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"weight","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"totalWeight","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"}],"name":"Abstained","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sender","type":"address"},{"indexed":true,"internalType":"address","name":"gauge","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"DistributeReward","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"poolFactory","type":"address"},{"indexed":true,"internalType":"address","name":"votingRewardsFactory","type":"address"},{"indexed":true,"internalType":"address","name":"gaugeFactory","type":"address"},{"indexed":false,"internalType":"address","name":"pool","type":"address"},{"indexed":false,"internalType":"address","name":"bribeVotingReward","type":"address"},{"indexed":false,"internalType":"address","name":"feeVotingReward","type":"address"},{"indexed":false,"internalType":"address","name":"gauge","type":"address"},{"indexed":false,"internalType":"address","name":"creator","type":"address"}],"name":"GaugeCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"gauge","type":"address"}],"name":"GaugeKilled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"gauge","type":"address"}],"name":"GaugeRevived","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sender","type":"address"},{"indexed":true,"internalType":"address","name":"reward","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"NotifyReward","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"voter","type":"address"},{"indexed":true,"internalType":"address","name":"pool","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"weight","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"totalWeight","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"}],"name":"Voted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"whitelister","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"},{"indexed":true,"internalType":"bool","name":"_bool","type":"bool"}],"name":"WhitelistNFT","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"whitelister","type":"address"},{"indexed":true,"internalType":"address","name":"token","type":"address"},{"indexed":true,"internalType":"bool","name":"_bool","type":"bool"}],"name":"WhitelistToken","type":"event"},{"inputs":[{"internalType":"address[]","name":"_bribes","type":"address[]"},{"internalType":"address[][]","name":"_tokens","type":"address[][]"},{"internalType":"uint256","name":"_tokenId","type":"uint256"}],"name":"claimBribes","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address[]","name":"_fees","type":"address[]"},{"internalType":"address[][]","name":"_tokens","type":"address[][]"},{"internalType":"uint256","name":"_tokenId","type":"uint256"}],"name":"claimFees","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address[]","name":"_gauges","type":"address[]"}],"name":"claimRewards","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"claimable","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_poolFactory","type":"address"},{"internalType":"address","name":"_pool","type":"address"}],"name":"createGauge","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_tokenId","type":"uint256"},{"internalType":"uint256","name":"_mTokenId","type":"uint256"}],"name":"depositManaged","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address[]","name":"_gauges","type":"address[]"}],"name":"distribute","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_start","type":"uint256"},{"internalType":"uint256","name":"_finish","type":"uint256"}],"name":"distribute","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"emergencyCouncil","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"epochGovernor","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_timestamp","type":"uint256"}],"name":"epochNext","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"uint256","name":"_timestamp","type":"uint256"}],"name":"epochStart","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"uint256","name":"_timestamp","type":"uint256"}],"name":"epochVoteEnd","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"uint256","name":"_timestamp","type":"uint256"}],"name":"epochVoteStart","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"factoryRegistry","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"forwarder","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"gaugeToBribe","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"gaugeToFees","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"gauges","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"governor","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"_tokens","type":"address[]"},{"internalType":"address","name":"_minter","type":"address"}],"name":"initialize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"isAlive","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"isGauge","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"forwarder","type":"address"}],"name":"isTrustedForwarder","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"isWhitelistedNFT","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"isWhitelistedToken","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_gauge","type":"address"}],"name":"killGauge","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"lastVoted","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"length","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"maxVotingNum","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"minter","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_amount","type":"uint256"}],"name":"notifyRewardAmount","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_tokenId","type":"uint256"}],"name":"poke","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"poolForGauge","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"poolVote","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"pools","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_tokenId","type":"uint256"}],"name":"reset","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_gauge","type":"address"}],"name":"reviveGauge","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_council","type":"address"}],"name":"setEmergencyCouncil","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_epochGovernor","type":"address"}],"name":"setEpochGovernor","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_governor","type":"address"}],"name":"setGovernor","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_maxVotingNum","type":"uint256"}],"name":"setMaxVotingNum","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"totalWeight","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_gauge","type":"address"}],"name":"updateFor","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"start","type":"uint256"},{"internalType":"uint256","name":"end","type":"uint256"}],"name":"updateFor","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address[]","name":"_gauges","type":"address[]"}],"name":"updateFor","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"usedWeights","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"v1Factory","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ve","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_tokenId","type":"uint256"},{"internalType":"address[]","name":"_poolVote","type":"address[]"},{"internalType":"uint256[]","name":"_weights","type":"uint256[]"}],"name":"vote","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"address","name":"","type":"address"}],"name":"votes","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"weights","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_tokenId","type":"uint256"},{"internalType":"bool","name":"_bool","type":"bool"}],"name":"whitelistNFT","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_token","type":"address"},{"internalType":"bool","name":"_bool","type":"bool"}],"name":"whitelistToken","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_tokenId","type":"uint256"}],"name":"withdrawManaged","outputs":[],"stateMutability":"nonpayable","type":"function"}]
const poolFactoryAbi = [{"inputs":[{"internalType":"address","name":"_implementation","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"FeeInvalid","type":"error"},{"inputs":[],"name":"FeeTooHigh","type":"error"},{"inputs":[],"name":"InvalidPool","type":"error"},{"inputs":[],"name":"NotFeeManager","type":"error"},{"inputs":[],"name":"NotPauser","type":"error"},{"inputs":[],"name":"NotSinkConverter","type":"error"},{"inputs":[],"name":"NotVoter","type":"error"},{"inputs":[],"name":"PoolAlreadyExists","type":"error"},{"inputs":[],"name":"SameAddress","type":"error"},{"inputs":[],"name":"ZeroAddress","type":"error"},{"inputs":[],"name":"ZeroFee","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"token0","type":"address"},{"indexed":true,"internalType":"address","name":"token1","type":"address"},{"indexed":true,"internalType":"bool","name":"stable","type":"bool"},{"indexed":false,"internalType":"address","name":"pool","type":"address"},{"indexed":false,"internalType":"uint256","name":"","type":"uint256"}],"name":"PoolCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"pool","type":"address"},{"indexed":false,"internalType":"uint256","name":"fee","type":"uint256"}],"name":"SetCustomFee","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"feeManager","type":"address"}],"name":"SetFeeManager","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"bool","name":"state","type":"bool"}],"name":"SetPauseState","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"pauser","type":"address"}],"name":"SetPauser","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"voter","type":"address"}],"name":"SetVoter","type":"event"},{"inputs":[],"name":"MAX_FEE","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ZERO_FEE_INDICATOR","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"allPools","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"allPoolsLength","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"tokenA","type":"address"},{"internalType":"address","name":"tokenB","type":"address"},{"internalType":"bool","name":"stable","type":"bool"}],"name":"createPair","outputs":[{"internalType":"address","name":"pool","type":"address"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"tokenA","type":"address"},{"internalType":"address","name":"tokenB","type":"address"},{"internalType":"bool","name":"stable","type":"bool"}],"name":"createPool","outputs":[{"internalType":"address","name":"pool","type":"address"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"tokenA","type":"address"},{"internalType":"address","name":"tokenB","type":"address"},{"internalType":"uint24","name":"fee","type":"uint24"}],"name":"createPool","outputs":[{"internalType":"address","name":"pool","type":"address"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"customFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"feeManager","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"pool","type":"address"},{"internalType":"bool","name":"_stable","type":"bool"}],"name":"getFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"tokenA","type":"address"},{"internalType":"address","name":"tokenB","type":"address"},{"internalType":"bool","name":"stable","type":"bool"}],"name":"getPair","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"tokenA","type":"address"},{"internalType":"address","name":"tokenB","type":"address"},{"internalType":"uint24","name":"fee","type":"uint24"}],"name":"getPool","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"tokenA","type":"address"},{"internalType":"address","name":"tokenB","type":"address"},{"internalType":"bool","name":"stable","type":"bool"}],"name":"getPool","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"implementation","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"pool","type":"address"}],"name":"isPair","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"isPaused","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"pool","type":"address"}],"name":"isPool","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"pauser","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"pool","type":"address"},{"internalType":"uint256","name":"fee","type":"uint256"}],"name":"setCustomFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bool","name":"_stable","type":"bool"},{"internalType":"uint256","name":"_fee","type":"uint256"}],"name":"setFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_feeManager","type":"address"}],"name":"setFeeManager","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bool","name":"_state","type":"bool"}],"name":"setPauseState","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_pauser","type":"address"}],"name":"setPauser","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_sinkConverter","type":"address"},{"internalType":"address","name":"_velo","type":"address"},{"internalType":"address","name":"_veloV2","type":"address"}],"name":"setSinkConverter","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_voter","type":"address"}],"name":"setVoter","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"sinkConverter","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"stableFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"velo","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"veloV2","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"volatileFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"voter","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"}];

async function getGauges(link) {
  const providerUrl = "https://optimism.llamarpc.com"
  const provider = new ethers.providers.JsonRpcProvider(providerUrl);

  const parsedUrl = new URL(link);

  const token0 = parsedUrl.searchParams.get('token0');
  const token1 = parsedUrl.searchParams.get('token1');
  const stable = parsedUrl.searchParams.get('stable') === 'true'

  const poolFactory = new ethers.Contract(poolFactoryAddress, poolFactoryAbi, provider)
  const poolAddress = await poolFactory["getPool(address,address,bool)"](token0, token1, stable)
  console.log("Pool address: ",poolAddress)

  const gaugeVoter = new ethers.Contract(gaugeVoterAddress, gaugeVoterAbi, provider)
  const gaugeAddress = await gaugeVoter.gauges(poolAddress)
  console.log('Gauge address: ',gaugeAddress)
}

const links = [
'https://velodrome.finance/deposit?token0=0x5976d4c3bcfc1c5f90ab1419d7f3ddf109cea35a&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=false',
'https://velodrome.finance/deposit?token0=0x5976d4c3bcfc1c5f90ab1419d7f3ddf109cea35a&token1=0x9560e827af36c94d2ac33a39bce1fe78631088db&stable=false',
'https://velodrome.finance/deposit?token0=0x259c1c2ed264402b5ed2f02bc7dc25a15c680c18&token1=0x4200000000000000000000000000000000000006&stable=false',
'https://velodrome.finance/deposit?token0=0x3417e54a51924c225330f8770514ad5560b9098d&token1=0x9560e827af36c94d2ac33a39bce1fe78631088db&stable=false',
'https://velodrome.finance/deposit?token0=0x3417e54a51924c225330f8770514ad5560b9098d&token1=0x4200000000000000000000000000000000000042&stable=false',
'https://velodrome.finance/deposit?token0=0x9560e827af36c94d2ac33a39bce1fe78631088db&token1=0xa50b23cdfb2ec7c590e84f403256f67ce6dffb84&stable=false',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0xa50b23cdfb2ec7c590e84f403256f67ce6dffb84&stable=false',
'https://velodrome.finance/deposit?token0=0x9e5aac1ba1a2e6aed6b32689dfcf62a509ca96f3&token1=0xbfd291da8a403daaf7e5e9dc1ec0aceacd4848b9&stable=false',
'https://velodrome.finance/deposit?token0=0x3a18dcc9745edcd1ef33ecb93b0b6eba5671e7ca&token1=0x9560e827af36c94d2ac33a39bce1fe78631088db&stable=false',
'https://velodrome.finance/deposit?token0=0x7ae97042a4a0eb4d1eb370c34bfec71042a056b7&token1=0x9560e827af36c94d2ac33a39bce1fe78631088db&stable=false',
'https://velodrome.finance/deposit?token0=0x2dad3a13ef0c6366220f989157009e501e7938f8&token1=0x9560e827af36c94d2ac33a39bce1fe78631088db&stable=false',
'https://velodrome.finance/deposit?token0=0x74ccbe53f77b08632ce0cb91d3a545bf6b8e0979&token1=0x9560e827af36c94d2ac33a39bce1fe78631088db&stable=false',
'https://velodrome.finance/deposit?token0=0x74ccbe53f77b08632ce0cb91d3a545bf6b8e0979&token1=0xc38464250f51123078bbd7ea574e185f6623d037&stable=false',
'https://velodrome.finance/deposit?token0=0x3b08fcd15280e7b5a6e404c4abb87f7c774d1b2e&token1=0x73cb180bf0521828d8849bc8cf2b920918e23032&stable=false',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0x9a2e53158e12bc09270af10c16a466cb2b5d7836&stable=false',
'https://velodrome.finance/deposit?token0=0x1db2466d9f5e10d7090e7152b68d62703a2245f0&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=false',
'https://velodrome.finance/deposit?token0=0x217d47011b23bb961eb6d93ca9945b7501a5bb11&token1=0x4200000000000000000000000000000000000006&stable=false',
'https://velodrome.finance/deposit?token0=0x6806411765af15bddd26f8f544a34cc40cb9838b&token1=0xc38464250f51123078bbd7ea574e185f6623d037&stable=false',
'https://velodrome.finance/deposit?token0=0x217d47011b23bb961eb6d93ca9945b7501a5bb11&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=false',
'https://velodrome.finance/deposit?token0=0x2dad3a13ef0c6366220f989157009e501e7938f8&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=false',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0xff733b2a3557a7ed6697007ab5d11b79fdd1b76b&stable=false',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0xb396b31599333739a97951b74652c117be86ee1d&stable=true',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0x9560e827af36c94d2ac33a39bce1fe78631088db&stable=false',
'https://velodrome.finance/deposit?token0=0x9560e827af36c94d2ac33a39bce1fe78631088db&token1=0xc38464250f51123078bbd7ea574e185f6623d037&stable=true',
'https://velodrome.finance/deposit?token0=0x2e3d870790dc77a83dd1d18184acc7439a53f475&token1=0xb396b31599333739a97951b74652c117be86ee1d&stable=true',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0x9560e827af36c94d2ac33a39bce1fe78631088db&stable=false',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0x74ccbe53f77b08632ce0cb91d3a545bf6b8e0979&stable=false',
'https://velodrome.finance/deposit?token0=0x28b42698caf46b4b012cf38b6c75867e0762186d&token1=0x4200000000000000000000000000000000000006&stable=false',
'https://velodrome.finance/deposit?token0=0x2e3d870790dc77a83dd1d18184acc7439a53f475&token1=0xdfa46478f9e5ea86d57387849598dbfb2e964b02&stable=true',
'https://velodrome.finance/deposit?token0=0x3a18dcc9745edcd1ef33ecb93b0b6eba5671e7ca&token1=0x9bcef72be871e61ed4fbbc7630889bee758eb81d&stable=false',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000042&token1=0x9560e827af36c94d2ac33a39bce1fe78631088db&stable=false',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0x8901cb2e82cc95c01e42206f8d1f417fe53e7af0&stable=false',
'https://velodrome.finance/deposit?token0=0xcb8fa9a76b8e203d8c3797bf438d8fb81ea3326a&token1=0xdfa46478f9e5ea86d57387849598dbfb2e964b02&stable=true',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0xc3864f98f2a61a7caeb95b039d031b4e2f55e0e9&stable=false',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0xdfa46478f9e5ea86d57387849598dbfb2e964b02&stable=true',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0xc03b43d492d904406db2d7d57e67c7e8234ba752&stable=false',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000042&token1=0x6806411765af15bddd26f8f544a34cc40cb9838b&stable=false',
'https://velodrome.finance/deposit?token0=0xca0e54b636db823847b29f506bffee743f57729d&token1=0xda10009cbd5d07dd0cecc66161fc93d7c9000da1&stable=true',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000042&token1=0x9485aca5bbbe1667ad97c7fe7c4531a624c8b1ed&stable=false',
'https://velodrome.finance/deposit?token0=0x73cb180bf0521828d8849bc8cf2b920918e23032&token1=0x8901cb2e82cc95c01e42206f8d1f417fe53e7af0&stable=false',
'https://velodrome.finance/deposit?token0=0x1f514a61bcde34f94bc39731235690ab9da737f7&token1=0x4200000000000000000000000000000000000042&stable=false',
'https://velodrome.finance/deposit?token0=0x50c5725949a6f0c72e6c4a641f24049a917db0cb&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=false',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0xc5102fe9359fd9a28f877a67e36b0f050d81a3cc&stable=false',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0xc55e93c62874d8100dbd2dfe307edc1036ad5434&stable=false',
'https://velodrome.finance/deposit?token0=0x33bca143d9b41322479e8d26072a00a352404721&token1=0x4200000000000000000000000000000000000042&stable=true',
'https://velodrome.finance/deposit?token0=0x8ae125e8653821e851f12a49f7765db9a9ce7384&token1=0xc5b001dc33727f8f26880b184090d3e252470d45&stable=true',
'https://velodrome.finance/deposit?token0=0x1610e3c85dd44af31ed7f33a63642012dca0c5a5&token1=0x4200000000000000000000000000000000000006&stable=true',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0x9e1028f5f1d5ede59748ffcee5532509976840e0&stable=false',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0x9dabae7274d28a45f0b65bf8ed201a5731492ca0&stable=true',
'https://velodrome.finance/deposit?token0=0x1f514a61bcde34f94bc39731235690ab9da737f7&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=false',
'https://velodrome.finance/deposit?token0=0x3ee6107d9c93955acbb3f39871d32b02f82b78ab&token1=0xc5b001dc33727f8f26880b184090d3e252470d45&stable=false',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000042&token1=0xaf9fe3b5ccdae78188b1f8b9a49da7ae9510f151&stable=false',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0x929b939f8524c3be977af57a4a0ad3fb1e374b50&stable=false',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0xcb8fa9a76b8e203d8c3797bf438d8fb81ea3326a&stable=true',
'https://velodrome.finance/deposit?token0=0x894134a25a5fac1c2c26f1d8fbf05111a3cb9487&token1=0xc40f949f8a4e094d1b49a23ea9241d289b7b2819&stable=true',
'https://velodrome.finance/deposit?token0=0x2e3d870790dc77a83dd1d18184acc7439a53f475&token1=0x8ae125e8653821e851f12a49f7765db9a9ce7384&stable=true',
'https://velodrome.finance/deposit?token0=0x00e1724885473b63bce08a9f0a52f35b0979e35a&token1=0x4200000000000000000000000000000000000006&stable=false',
'https://velodrome.finance/deposit?token0=0x73cb180bf0521828d8849bc8cf2b920918e23032&token1=0x8ae125e8653821e851f12a49f7765db9a9ce7384&stable=true',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0x8ae125e8653821e851f12a49f7765db9a9ce7384&stable=true',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0x8700daec35af8ff88c16bdf0418774cb3d7599b4&stable=false',
'https://velodrome.finance/deposit?token0=0x15e770b95edd73fd96b02ece0266247d50895e76&token1=0x4200000000000000000000000000000000000006&stable=false',
'https://velodrome.finance/deposit?token0=0x8ae125e8653821e851f12a49f7765db9a9ce7384&token1=0xdfa46478f9e5ea86d57387849598dbfb2e964b02&stable=true',
'https://velodrome.finance/deposit?token0=0x2e3d870790dc77a83dd1d18184acc7439a53f475&token1=0x73cb180bf0521828d8849bc8cf2b920918e23032&stable=true',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000042&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=false',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0x9485aca5bbbe1667ad97c7fe7c4531a624c8b1ed&stable=false',
'https://velodrome.finance/deposit?token0=0x2e3d870790dc77a83dd1d18184acc7439a53f475&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=true',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0xbfd291da8a403daaf7e5e9dc1ec0aceacd4848b9&stable=true',
'https://velodrome.finance/deposit?token0=0x73cb180bf0521828d8849bc8cf2b920918e23032&token1=0x970d50d09f3a656b43e11b0d45241a84e3a6e011&stable=true',
'https://velodrome.finance/deposit?token0=0x73cb180bf0521828d8849bc8cf2b920918e23032&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=true',
'https://velodrome.finance/deposit?token0=0x73cb180bf0521828d8849bc8cf2b920918e23032&token1=0xc40f949f8a4e094d1b49a23ea9241d289b7b2819&stable=true',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0xdc6ff44d5d932cbd77b52e5612ba0529dc6226f1&stable=false',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0x4200000000000000000000000000000000000042&stable=false',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0x8c6f28f2f1a3c87f0f938b96d27520d9751ec8d9&stable=true',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0xc40f949f8a4e094d1b49a23ea9241d289b7b2819&stable=false',
'https://velodrome.finance/deposit?token0=0x296f55f8fb28e498b858d0bcda06d955b2cb3f97&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=false',
'https://velodrome.finance/deposit?token0=0x484c2d6e3cdd945a8b2df735e079178c1036578c&token1=0x6806411765af15bddd26f8f544a34cc40cb9838b&stable=true',
'https://velodrome.finance/deposit?token0=0x68f180fcce6836688e9084f035309e29bf0a2095&token1=0x6c84a8f1c29108f47a79964b5fe888d4f4d0de40&stable=true',
'https://velodrome.finance/deposit?token0=0x2e3d870790dc77a83dd1d18184acc7439a53f475&token1=0xcb8fa9a76b8e203d8c3797bf438d8fb81ea3326a&stable=true',
'https://velodrome.finance/deposit?token0=0xc40f949f8a4e094d1b49a23ea9241d289b7b2819&token1=0xc5b001dc33727f8f26880b184090d3e252470d45&stable=true',
'https://velodrome.finance/deposit?token0=0x00a35fd824c717879bf370e70ac6868b95870dfb&token1=0x4200000000000000000000000000000000000006&stable=false',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=false',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0x6c84a8f1c29108f47a79964b5fe888d4f4d0de40&stable=false',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0xc40f949f8a4e094d1b49a23ea9241d289b7b2819&stable=true',
'https://velodrome.finance/deposit?token0=0x4200000000000000000000000000000000000006&token1=0x6806411765af15bddd26f8f544a34cc40cb9838b&stable=true',
'https://velodrome.finance/deposit?token0=0x94b008aa00579c1307b0ef2c499ad98a8ce58e58&token1=0xc40f949f8a4e094d1b49a23ea9241d289b7b2819&stable=true',
'https://velodrome.finance/deposit?token0=0x79af5dd14e855823fa3e9ecacdf001d99647d043&token1=0x9485aca5bbbe1667ad97c7fe7c4531a624c8b1ed&stable=true',
'https://velodrome.finance/deposit?token0=0x1f32b1c2345538c0c6f582fcb022739c4a194ebb&token1=0x4200000000000000000000000000000000000006&stable=false',
'https://velodrome.finance/deposit?token0=0x3e29d3a9316dab217754d13b28646b76607c5f04&token1=0x6806411765af15bddd26f8f544a34cc40cb9838b&stable=true',
'https://velodrome.finance/deposit?token0=0x3e29d3a9316dab217754d13b28646b76607c5f04&token1=0x4200000000000000000000000000000000000006&stable=true',
'https://velodrome.finance/deposit?token0=0x0b2c639c533813f4aa9d7837caf62653d097ff85&token1=0x7f5c764cbc14f9669b88837ca1490cca17c31607&stable=true',
'https://velodrome.finance/deposit?token0=0x1f32b1c2345538c0c6f582fcb022739c4a194ebb&token1=0xfdb794692724153d1488ccdbe0c56c252596735f&stable=false',
'https://velodrome.finance/deposit?token0=0x7f5c764cbc14f9669b88837ca1490cca17c31607&token1=0x94b008aa00579c1307b0ef2c499ad98a8ce58e58&stable=true',
];

async function processLinks(links) {
  for (const link of links) {
    await getGauges(link);
  }
}

processLinks(links)
  .then(() => {
    console.log("Done");
  })
  .catch((error) => {
    console.error("Error", error);
  });